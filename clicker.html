<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>Coin Tap Clicker</title>
  <style>
    :root {
      --bg: #0f1220;
      --text: #e8ecff;
      --gold-1: #fff3b0;
      --gold-2: #ffd24a;
      --gold-3: #f2b634;
      --gold-4: #b8830f;
      --gold-5: #7a5809;
      --glow: #ffd24a55;
      --mint-shadow: rgba(0,0,0,.55);
    }

    * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      background:
        radial-gradient(1200px 800px at 50% -20%, #243066 0%, transparent 60%),
        radial-gradient(1000px 600px at 50% 120%, #1a233f 0%, transparent 60%),
        var(--bg);
      color: var(--text);
      display: grid;
      place-items: center;
      touch-action: manipulation;
      user-select: none;
    }

    .app { position: relative; width: 100vw; height: 100vh; max-width: 480px; overflow: hidden; }

    .hud {
      position: absolute; top: calc(env(safe-area-inset-top, 0) + 18px); left: 0; right: 0;
      text-align: center; font-weight: 800; font-size: clamp(28px, 6vw, 40px); letter-spacing:.3px;
      text-shadow: 0 2px 6px rgba(0,0,0,.4); pointer-events: none;
    }
    .score-label { display:block; opacity:.65; font-size: .45em; margin-bottom: 4px; }
    #score { display:block; font-variant-numeric: tabular-nums; }
    #bonusBadge { display:inline-block; margin-left: 8px; font-size: .45em; font-weight: 900; padding: 4px 8px; border-radius: 999px; background: #22c55e22; outline: 2px solid #22c55e55; opacity: 0; transform: translateY(-6px); transition: opacity .2s ease, transform .2s ease; }
    #bonusBadge.show { opacity: 1; transform: translateY(0); }

    .stage { position: absolute; inset: 0; display: grid; place-items: center; padding: 60px 24px; }

    .coin {
      width: min(56vh, 72vw);
      aspect-ratio: 1/1;
      border-radius: 50%;
      position: relative;
      cursor: pointer;
      transition: transform .08s ease, filter .08s ease, box-shadow .08s ease;
      background:
        radial-gradient(120% 120% at 35% 30%, var(--gold-1) 0%, var(--gold-2) 40%, var(--gold-3) 70%),
        conic-gradient(from 0deg, rgba(255,255,255,.25), rgba(0,0,0,.15), rgba(255,255,255,.2), rgba(0,0,0,.2), rgba(255,255,255,.15));
      box-shadow:
        inset 0 0 0 8px rgba(255,255,255,.28),
        inset 0 0 0 14px rgba(0,0,0,.06),
        inset 10px 10px 22px rgba(0,0,0,.28),
        inset -10px -10px 24px rgba(255,255,255,.38),
        0 22px 40px var(--mint-shadow),
        0 10px 18px rgba(0,0,0,.35);
    }
    .coin::before {
      content: "";
      position: absolute; inset: 8%; border-radius: 50%;
      box-shadow:
        inset 0 0 0 12px rgba(0,0,0,.12),
        inset 8px 8px 14px rgba(0,0,0,.25),
        inset -8px -8px 16px rgba(255,255,255,.45);
      background: radial-gradient(120% 120% at 35% 30%, rgba(255,255,255,.5), rgba(0,0,0,.08));
      pointer-events: none;
    }
    .coin::after {
      content: "";
      position: absolute; inset: 0; border-radius: 50%;
      background: radial-gradient(70% 50% at 30% 20%, rgba(255,255,255,.35), transparent 60%);
      mix-blend-mode: screen; pointer-events: none;
    }

    .coin.pressed {
      transform: translateY(4px) scale(.965);
      filter: brightness(.98) saturate(.96);
      box-shadow:
        inset 0 0 0 8px rgba(255,255,255,.2),
        inset 0 0 0 14px rgba(0,0,0,.08),
        inset 6px 6px 16px rgba(0,0,0,.35),
        inset -8px -8px 12px rgba(255,255,255,.25),
        0 12px 22px var(--mint-shadow),
        0 6px 12px rgba(0,0,0,.35);
    }

    .floater { position: absolute; font-weight: 900; opacity: 0; pointer-events: none; animation: pop 700ms ease-out forwards; font-size: clamp(26px, 6vw, 40px); text-shadow: 0 2px 8px rgba(0,0,0,.6); }
    @keyframes pop { 0% { transform: translateY(0) scale(.85); opacity: 0; } 20% { opacity: 1; } 100% { transform: translateY(-46px) scale(1.12); opacity: 0; } }

    .gaugeWrap { position: absolute; left: 16px; right: 16px; bottom: calc(env(safe-area-inset-bottom,0) + 18px); background: #0b0e1e; border-radius: 999px; padding: 6px; box-shadow: inset 0 0 0 1px rgba(255,255,255,.06); }
    .gauge { height: 12px; border-radius: 999px; width: 0%; background: linear-gradient(90deg, #ffe08a, #ffc343); box-shadow: 0 0 22px var(--glow); transition: width .15s ease; }
    .gaugeHint { text-align:center; font-size: 12px; opacity:.7; margin-top: 6px; }
  </style>
</head>
<body>
  <div class="app" id="app">
    <div class="hud">
      <span class="score-label">SCORE</span>
      <span id="score">0</span>
      <span id="bonusBadge">x2 10s</span>
    </div>

    <div class="stage">
      <div class="coin" id="coin" role="button" aria-label="Pièce – appuyez pour gagner des points" tabindex="0"></div>
    </div>

    <div class="gaugeWrap">
      <div class="gauge" id="gauge"></div>
      <div class="gaugeHint" id="gaugeHint">Bonus x2 à 100</div>
    </div>
  </div>

  <script>
    (function(){
      const app = document.getElementById('app');
      const coin = document.getElementById('coin');
      const scoreEl = document.getElementById('score');
      const gauge = document.getElementById('gauge');
      const gaugeHint = document.getElementById('gaugeHint');
      const badge = document.getElementById('bonusBadge');

      let score = 0;
      let progress = 0;
      let nextThreshold = 100;
      let bonusActive = false;
      let bonusTimer = null;

      function setBadge(on, secondsLeft = 10){
        badge.textContent = `x2 ${secondsLeft}s`;
        badge.classList.toggle('show', !!on);
      }

      function startBonus(){
        bonusActive = true;
        let left = 10;
        setBadge(true, left);
        if (bonusTimer) clearInterval(bonusTimer);
        bonusTimer = setInterval(() => {
          left -= 1;
          if (left <= 0) {
            clearInterval(bonusTimer); bonusTimer = null; bonusActive = false; setBadge(false);
          } else { setBadge(true, left); }
        }, 1000);
      }

      function updateScore(delta){
        score += delta;
        scoreEl.textContent = score.toLocaleString('fr-FR');
      }

      function updateGauge(add){
        progress += add;
        while (progress >= nextThreshold){
          progress -= nextThreshold;
          startBonus();
          nextThreshold *= 2;
        }
        const pct = Math.min(100, (progress / nextThreshold) * 100);
        gauge.style.width = pct + '%';
        gaugeHint.textContent = `Bonus x2 à ${nextThreshold}`;
      }

      function pressVisual(on){ coin.classList.toggle('pressed', !!on); }

      function spawnFloater(x, y, value){
        const f = document.createElement('div');
        f.className = 'floater';
        f.textContent = `+${value}`;
        app.appendChild(f);
        const rect = app.getBoundingClientRect();
        f.style.left = (x - rect.left + (Math.random()-0.5)*16) + 'px';
        f.style.top  = (y - rect.top - 10) + 'px';
        f.addEventListener('animationend', () => f.remove());
      }

      function haptic(){ if (navigator.vibrate) navigator.vibrate(8); }

      function clickOnce(x, y){
        const mult = bonusActive ? 2 : 1;
        const gain = 1 * mult;
        updateScore(gain);
        updateGauge(gain);
        const cx = (x == null) ? (window.innerWidth/2) : x;
        const cy = (y == null) ? (window.innerHeight/2) : y;
        spawnFloater(cx, cy, gain);
        haptic();
      }

      let isDown = false;
      coin.addEventListener('pointerdown', (e) => { isDown = true; pressVisual(true); clickOnce(e.clientX, e.clientY); }, {passive:true});
      window.addEventListener('pointerup', () => { if (!isDown) return; isDown=false; pressVisual(false); }, {passive:true});
      coin.addEventListener('pointerleave', () => { if (!isDown) return; isDown=false; pressVisual(false); }, {passive:true});

      coin.addEventListener('keydown', (e) => { if (e.key === ' ' || e.key === 'Enter') { e.preventDefault(); pressVisual(true); clickOnce(); } });
      coin.addEventListener('keyup', (e) => { if (e.key === ' ' || e.key === 'Enter') pressVisual(false); });

      coin.addEventListener('click', () => coin.blur());
    })();
  </script>
</body>
</html>
